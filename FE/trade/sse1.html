<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>SSE OrderBook í…ŒìŠ¤íŠ¸</title>
  </head>
  <body>
    <h2>OrderBook SSE ìˆ˜ì‹  ê²°ê³¼</h2>
    <pre id="output">ì—°ê²° ì¤‘...</pre>
    <script>
      const coinId = '5ad4a66b-a017-4e16-85af-bed654a001c4';
      const evtSource = new EventSource(
        `http://localhost:8081/api/coins/${coinId}/orders/orderbook`
      );
      evtSource.onopen = () => {
        document.getElementById('output').textContent =
          'âœ… ì—°ê²° ì„±ê³µ. ë°ì´í„° ìˆ˜ì‹  ëŒ€ê¸° ì¤‘...\n';
      };
      evtSource.addEventListener('init', e => {
        document.getElementById(
          'output'
        ).textContent += `âœ… ì´ˆê¸° ì—°ê²° ë©”ì‹œì§€: ${e.data}\n\n`;
        console.log('âœ… ì—°ê²°ë¨:', e.data);
      });
      evtSource.addEventListener('orderbook', function (event) {
        const parsedData = JSON.parse(event.data);
        document.getElementById(
          'output'
        ).textContent += `ğŸ“ˆ ìˆ˜ì‹ : \n${JSON.stringify(
          parsedData,
          null,
          2
        )}\n\n`;
      });
      evtSource.onmessage = function (e) {
        console.log('ğŸ“¦ ê¸°ë³¸ ë©”ì‹œì§€ ìˆ˜ì‹ :', e.data);
      };
      evtSource.onerror = function (err) {
        console.error('âŒ SSE ì—ëŸ¬ ë°œìƒ:', err);
        document.getElementById('output').textContent += 'âŒ ì—°ê²° ì—ëŸ¬ ë°œìƒ\n';
      };
    </script>
  </body>
</html>
